# Live2D 운세 앱 통합 테스트 가이드

## 개요
이 문서는 백엔드 API와 완전히 연동된 Live2D 운세 앱의 통합 테스트 시나리오를 정의합니다.

## 테스트 환경 요구사항

### 백엔드 서버
- Python FastAPI 서버 (포트 8000)
- 운세 API v2 엔드포인트 활성화
- WebSocket 서버 활성화
- Live2D API 엔드포인트 활성화

### 프론트엔드
- React 개발 서버 (포트 3000)
- 모든 새로운 서비스와 컴포넌트 로드

## 주요 테스트 시나리오

### 1. 앱 초기화 플로우
**목표**: 앱이 정상적으로 초기화되고 백엔드와 연결되는지 확인

**테스트 단계**:
1. 브라우저에서 `http://localhost:3000` 접속
2. 로딩 스피너가 표시되는지 확인
3. 사용자 서비스가 익명 사용자를 생성하는지 확인
4. WebSocket 연결이 성공하는지 확인
5. Live2D 뷰어가 초기화되는지 확인
6. 채팅 인터페이스가 활성화되는지 확인

**예상 결과**:
- 로딩 완료 후 메인 화면 표시
- 연결 상태가 "연결됨"으로 표시
- Live2D 상태가 "ready"로 표시
- 미라의 환영 메시지가 채팅에 표시

### 2. 사용자 정보 입력 및 일일 운세 플로우
**목표**: 새 사용자가 정보를 입력하고 일일 운세를 받는 전체 플로우

**테스트 단계**:
1. "일일 운세" 카드 클릭
2. 사용자 정보 입력 폼이 표시되는지 확인
3. 필수 정보 입력:
   - 생년월일: 1990-01-01
   - 성별: 선택사항
4. "운세 보기" 버튼 클릭
5. 백엔드 API 호출 확인 (개발자 도구 Network 탭)
6. 운세 결과 모달이 표시되는지 확인
7. Live2D 캐릭터가 반응하는지 확인

**예상 결과**:
- POST `/fortune/v2/daily` 호출 성공
- 운세 결과 데이터 수신
- 모달에 운세 내용, 점수, 행운 아이템 등 표시
- Live2D 캐릭터가 적절한 표정/모션으로 반응

### 3. 타로 카드 운세 플로우
**목표**: 타로 카드 선택부터 결과까지의 전체 플로우

**테스트 단계**:
1. "타로 카드" 카드 클릭
2. 카드 뽑기 화면으로 전환되는지 확인
3. 3장의 카드 선택
4. 선택 완료 시 백엔드 API 호출 확인
5. 타로 운세 결과 표시 확인
6. Live2D 캐릭터 반응 확인

**예상 결과**:
- POST `/fortune/v2/tarot` 호출 성공
- 선택한 카드 정보가 요청에 포함
- 타로 특화 결과 (카드 해석, 조언 등) 표시
- Live2D가 "card_draw" 모션 실행

### 4. 실시간 채팅 플로우
**목표**: WebSocket을 통한 실시간 채팅 기능

**테스트 단계**:
1. 채팅 입력창에 메시지 입력: "안녕하세요!"
2. 메시지 전송 확인
3. WebSocket으로 메시지가 전송되는지 확인
4. 백엔드 응답 수신 확인
5. Live2D 캐릭터가 메시지에 반응하는지 확인
6. 채팅 히스토리가 로컬 저장되는지 확인

**예상 결과**:
- WebSocket 메시지 전송 성공
- AI 응답 수신 및 채팅창에 표시
- Live2D 감정 변화 (메시지 내용에 따라)
- 페이지 새로고침 후에도 채팅 히스토리 유지

### 5. Live2D 상호작용 플로우
**목표**: Live2D 캐릭터와의 상호작용 및 백엔드 동기화

**테스트 단계**:
1. Live2D 캐릭터 캔버스 클릭
2. 로컬 인터랙션 반응 확인
3. 백엔드 Live2D API 호출 확인
4. WebSocket을 통한 상태 동기화 확인
5. 다른 브라우저/탭에서 동일 세션 ID로 접속하여 동기화 확인

**예상 결과**:
- 클릭 위치에 따른 적절한 반응
- POST `/api/live2d/emotion` 또는 `/api/live2d/motion` 호출
- WebSocket으로 상태 동기화 메시지 전송
- 다중 클라이언트 간 Live2D 상태 동기화

### 6. 에러 처리 및 복구 플로우
**목표**: 네트워크 오류나 서버 오류 상황에서의 앱 동작

**테스트 단계**:
1. 백엔드 서버 중단
2. 운세 요청 시 에러 처리 확인
3. WebSocket 재연결 시도 확인
4. 백엔드 서버 재시작
5. 자동 복구 확인

**예상 결과**:
- 적절한 에러 메시지 표시
- 재시도 버튼 제공
- WebSocket 자동 재연결 시도
- 서버 복구 후 정상 기능 재개

### 7. 다양한 운세 타입 테스트
**목표**: 모든 운세 타입의 정상 동작 확인

**테스트 단계**:
1. 각 운세 타입별로 요청:
   - 일일 운세: 기본 생년월일만 입력
   - 별자리 운세: 생년월일로 별자리 자동 계산
   - 사주 운세: 생년월일 + 출생시간 입력
   - 타로 운세: 카드 선택
2. 각각의 고유한 결과 형식 확인
3. Live2D 반응의 차이점 확인

**예상 결과**:
- 각 API 엔드포인트 정상 호출
- 운세 타입별 특화된 결과 데이터
- Live2D 모션의 차이 (crystal_gaze, card_draw, blessing 등)

## 성능 테스트

### 1. 로딩 성능
- 앱 초기화 시간: < 3초
- WebSocket 연결 시간: < 1초
- 운세 API 응답 시간: < 2초

### 2. 메모리 사용량
- 초기 로딩 후: < 100MB
- 장시간 사용 후: < 200MB (메모리 누수 없음)

### 3. WebSocket 안정성
- 1시간 연결 유지 테스트
- 네트워크 끊김 상황에서 재연결 테스트

## 브라우저 호환성 테스트

### 지원 브라우저
- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

### 모바일 테스트
- iOS Safari
- Android Chrome
- 반응형 디자인 확인

## 테스트 체크리스트

### 필수 기능
- [ ] 앱 초기화 및 로딩
- [ ] 사용자 세션 생성
- [ ] WebSocket 연결
- [ ] 4가지 운세 타입 모두 정상 작동
- [ ] 실시간 채팅
- [ ] Live2D 인터랙션
- [ ] 에러 처리 및 복구

### 사용자 경험
- [ ] 직관적인 UI/UX
- [ ] 적절한 로딩 표시
- [ ] 명확한 에러 메시지
- [ ] 반응형 디자인

### 기술적 안정성
- [ ] 메모리 누수 없음
- [ ] WebSocket 재연결
- [ ] API 에러 처리
- [ ] 브라우저 호환성

## 알려진 이슈 및 제한사항

### 현재 제한사항
1. Live2D SDK는 플레이스홀더로 구현됨
2. 실제 AI 대화는 백엔드 구현에 따라 다름
3. 실시간 멀티유저 동기화는 세션 기반으로만 구현

### 향후 개선사항
1. 실제 Live2D 모델 및 SDK 통합
2. 고급 AI 대화 시스템
3. 사용자 계정 시스템
4. 운세 히스토리 관리

## 결론

이 통합 테스트를 통해 백엔드 API와 완전히 연동된 Live2D 운세 앱의 모든 핵심 기능이 정상적으로 작동하는지 확인할 수 있습니다. 각 테스트 시나리오를 순차적으로 실행하여 전체 시스템의 안정성과 사용자 경험을 검증하세요.